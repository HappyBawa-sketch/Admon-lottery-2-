<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Debugger</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        // Import Firebase functions needed for a minimal check
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // This function will check the Firebase variables and display a message
        window.onload = async () => {
            const statusDiv = document.getElementById('status-message');
            const detailsDiv = document.getElementById('details');

            try {
                // Check if the Firebase configuration is available
                const firebaseConfigString = typeof __firebase_config !== 'undefined' ? __firebase_config : null;
                if (!firebaseConfigString) {
                    throw new Error("Missing Firebase configuration variable (__firebase_config).");
                }
                
                // Parse the config to ensure it's valid JSON
                const firebaseConfig = JSON.parse(firebaseConfigString);
                if (Object.keys(firebaseConfig).length === 0) {
                     throw new Error("The Firebase configuration is empty.");
                }

                // Check if the authentication token is available
                const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                if (!initialAuthToken) {
                    throw new Error("Missing authentication token variable (__initial_auth_token).");
                }

                // Try to initialize Firebase and authenticate
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);
                await signInWithCustomToken(auth, initialAuthToken);

                // If all checks pass, show success
                statusDiv.textContent = 'SUCCESS!';
                statusDiv.classList.remove('text-red-500', 'text-yellow-500');
                statusDiv.classList.add('text-green-500');
                detailsDiv.textContent = 'Firebase config and authentication token are available and working.';

            } catch (error) {
                // If any check fails, show the specific error message
                statusDiv.textContent = 'FAILURE';
                statusDiv.classList.remove('text-green-500');
                statusDiv.classList.add('text-red-500');
                detailsDiv.textContent = `Detailed Error: ${error.message}`;
            }
        };
    </script>
</head>
<body class="bg-gray-100 p-8 flex flex-col items-center justify-center min-h-screen font-sans">
    <div class="bg-white rounded-lg shadow-xl p-8 max-w-lg w-full text-center">
        <h1 class="text-3xl font-bold mb-4">Firebase Status Check</h1>
        <div class="text-4xl font-extrabold" id="status-message">LOADING...</div>
        <p class="mt-4 text-gray-700" id="details">Checking Firebase configuration and authentication...</p>
    </div>
</body>
</html>
